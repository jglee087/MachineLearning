# 1. 딥러닝과 파이토치

### 1.1 인공지능과 머신러닝

인공지능은 인간의 사고를 인공적으로 모방한 것을 의미한다. 인공지능을 구현하는 방법은 다양하고 머신러닝도 그중 하나이다. 머신러닝이란 데이터를 가지고 통계학적인 모델을 학습시켜 인공지능을 구현하는 방법이며 딥러닝은 머신러닝의 방법론 중 하나이다.

초기의 인공지능 개발 방법은 입력부터 출력까지 컴퓨터에게 모두 학습시키는 것이었다면 머신러닝은 사람이 정답을 알려주고 입력을 주면 컴퓨터가 정답을 찾기 위해 스스로 학습을 하고 적합한 모델을 찾고자 하는 것이다.



### 1.2 지도학습, 비지도학습, 강화학습

모델에 데이터를 입력했을 때 원하는 결과가 출력되도록 모델 내부의 변수들을 조금씩 조율하는 과정을 **학습**이라고 한다. 데이터의 특징과 학습 방식에 따라 머신러닝을 세지도학습, 비지도학습, 강화학습 등으로 구분한다. <u>지도학습</u>은 모델에게 입력과 출력(정답)을 주고 이 데이터를 학습을 한 후에 새로운 데이터를 보고 결과를 예측하는데 쓰인다. 단점은 사람이 정답을 모두 준비해야 한다는 것이다.

<u>비지도학습</u>은 지도학습과 달리 정답이 없는 데이터로 학습한다. 이 데이터로부터는 주로 군집 분석, 데이터 표현, 차원 감소 등의 일을 컴퓨터가 하고 지도학습은 보조하는 용도로 쓰인다. 

지도학습과 비지도학습은 모두 정적인 데이터로 학습한다. 머신러닝의 세 번째 분류인 <u>강화학습</u>은 보상과 처벌 체계를 세우고 모델이 환경을 경험하며 배운다는 점에서 동적이라 할 수 있다. 예를 들면, 게임 같이 주어진 환경에서 상호작용하며 높은 점수를 얻는 방법을 배우는 것이다.

지도학습, 비지도학습, 강화학습 외에도 여러 학습 바업이 존재한다. 대표적으로 레이블이 부족한 데이터를 학습하는 준지도학습, 학습법 자체를 연구하는 메타학습, 반복 없이 데이터를 한 번 혹은 몇 번만 보고 학습하는 원샷 학습, 한문 제를 위해 학습한 후 다른 문제에도 바로 적용하는 전이학습 등이 있다.



### 1.3 딥러닝과 신경망

데이터 사이의 복잡한 관계를 스스로 학습하는 알고리즘은 의사결정 나무, 서포트 벡터 머신, 랜덤 포레스트 등 수많은 알고리즘이 개발되었다. 그리고 머신러닝 알고리즘 중 인공 신경망이라는 알고리즘이 있다. 인공 신경망의 층을 여러 겹 쌓아 학습한다면 심층 인공 신경망(deep neural network), 즉 이것이 딥러닝이다.

정제되지 않은 데이터를 머신러닝 알고리즘에 입력하려면 데이터의 특징을 사람이 직접 추출해야 한다. 예를 들어 입체적인 컬러 이미지는 너무 복잡하기 때문에 이미지의 테두리만 윤곽선 검출 등의 과정을 거쳐 머신러닝 모델이 소화하기 쉽게 만들어야 한다. 이렇게 특징을 추출하는 작업을 **특징 추출** 또는 **특징 공학**이라고 한다. 

딥러닝에 제약이 몇가지가 있다. 첫 번째는 데이터양이다. 일반적으로 딥러닝 알고리즘이 높은 정확도를 내려면 엄청난 양의 학습 데이터가 필요하다. 두번째는 시간과 하드웨어 이다. 딥러닝 알고리즘은 대량의 데이터로 수식을 수백만 번 이상 계산하면서 학습하므로 높은 사양의 컴퓨팅 자원과 시간이 든다.



### 1.4 파이토치가 개발되기까지

딥러닝 알고리즘들은 행렬연산을 반복하게 되는데, 기존 어느 영역의 알고리즘에서도 쉽게 볼 수 없던 많은 계산량이다. 실제 데이터를 이용해 학습할 때는 오랜 시간이 걸리는 경우도 있다.

이 연산량 문제를 해결하기 위해 딥러닝 초기 발전을 이끌던 연구실에서 GPU를 사용하여 행렬연산을 가속하는 테아노(Theano)라는 프레임워크를 발표했다.

이후 케라스(Keras)같은 오픈소스 라이브러리들이 테아노를 기반으로 탄생하였고, 많은 연구자와 개발자가 테아노에 의존하여 딥러닝 발전에 기여했지만 직관적이지 않은 사용법과 잦은 버그, 대형 모델에 적용하기 어려운 점 때문에 2017년 가을 개발이 중단되었다.

테아노를 개발하며 익힌 개발 노하우는 이후 여러 딥러닝 프레임워크의 개발에 지대한 영향을 끼쳤다. 여러 기여자가 오픈소스 도구들을 개발한 덕분에 더 이상 고등 연구기관에서만 접할수 있는 어려운 주제가 아니게 되었다. 텐서플로를 비롯한 카페, MXnet, CNTK 등이 그 예이다.

파이토치(PyTorch)는 텐서플로 이후 탄생한 비교적 새로운 딥러닝 프레임워크이다. 그래서 기존 딥러닝 프레임워크에서 아쉬웠던 부분을 채워주는 기능들을 제공한다.



### 1.5 왜 파이토치인가?

파이토치는 페이스북 주도로 여러 회사와 대학이 합심해 개발한 오픈소스 소프트웨어로, 머신러닝과 딥러닝 모델을 쉽게 구현할 수 있도록 많은 편의 기능을 제공하는 프레임워크이다. 물론 이러한 기능들을 파이토치에서만 제공하는 것은 아니다. 하지만 파이토치는 가장 간결하고 직관적이고, 코드가 의미하는 바를 그대로 나타내기 때문에 '파이썬다움'을 가장 잘 살린 딥러닝 프레임워크이다. 파이토치는 파이썬과 넘파이의 기초를 익힌 사람이라면 누구나 쉽게 적응하고 사용할 수 있다.

텐서플로를 비롯한 대부분의 딥러닝 프레임워크가 파이썬을 사용하지만, 변수들이 지나가는 길인 '그래프'를 미리 정해두고 실행 중에는 바꿀 수 없기 때문에 마치 C를 사용하는 느낌을 준다. 이것을 정적 계싼 그래프(static compuatational) 방식이라고 부른다. 정적 계산 그래프는 그래프 계산 방식을 최초에 정해두기 때문에 최적화하기 쉽다는 장점이 있다. 하지만 유연함을 추구하는 인터프리터언어인 파이썬과 정적 계산 그래프 방식은 어색한 조합일 수밖에 없다.

반면 파이토치는 실행 중에 그래프를 바꿀 수 있다. 이것을 동적 계산 그래프(dynamic computational graph) 방식이라고 한다. 동적 계산 그래프 방식은 데이터에 유연한 모델을 만들 수 있다는 장점이 있다.

많은 딥러닝 프레임워크들은 정적인 데이터셋으로 학습하고 정적인 모델을 배포하여 쓰는 오프라인 학습에 최적화되어 있다. 미래에는 데이터에 실시간으로 대응하는 동적인 학습 방법이 중요해질 전망으로 파이토치는 실행 도중 모델을 유연하게 관리할 수 있어 미래지향적이라고 할 수 있다.

